<script>
    const dice = document.getElementById('dice');
    const resultElement = document.getElementById('result');
    const faces = [
        "Kiss",
        "Dance together",
        "Roll again",
        "Kiss",
        "Take a photo",
        "Dance together"
    ];
    
    // Rotaciones base de cada cara
    const rotations = [
        'rotateX(0deg) rotateY(0deg)',      // Cara 1 (frontal)
        'rotateX(0deg) rotateY(180deg)',    // Cara 2 (trasera)
        'rotateX(0deg) rotateY(90deg)',     // Cara 3 (derecha)
        'rotateX(0deg) rotateY(-90deg)',    // Cara 4 (izquierda)
        'rotateX(-90deg) rotateY(0deg)',    // Cara 5 (arriba)
        'rotateX(90deg) rotateY(0deg)'      // Cara 6 (abajo)
    ];

    let isRolling = false;
    let rolledIndex = null;

    function setAllFacesToDots() {
        document.querySelectorAll('.face-content').forEach(face => {
            face.innerHTML = `
                <div class="dots">
                    <div class="dot topleft"></div>
                    <div class="dot bottomright"></div>
                    <div class="dot center"></div>
                    <div class="dot topright"></div>
                    <div class="dot bottomleft"></div>
                </div>
            `;
        });
    }

    function setFacesForResult(index) {
        document.querySelectorAll('.cube-face').forEach((face, i) => {
            if (i === index) {
                face.querySelector('.face-content').innerHTML = `
                    <span class="option-text">${faces[index]}</span>
                `;
            } else {
                face.querySelector('.face-content').innerHTML = `
                    <div class="dots">
                        <div class="dot topleft"></div>
                        <div class="dot bottomright"></div>
                        <div class="dot center"></div>
                        <div class="dot topright"></div>
                        <div class="dot bottomleft"></div>
                    </div>
                `;
            }
        });
    }

    function rollDice() {
        if (isRolling) return;

        isRolling = true;
        resultElement.classList.remove('show');

        rolledIndex = Math.floor(Math.random() * 6);
        setFacesForResult(rolledIndex);

        // Obtener la rotación base final
        const match = rotations[rolledIndex].match(/rotateX\((-?\d+)deg\)\srotateY\((-?\d+)deg\)/);
        const finalX = parseInt(match[1]);
        const finalY = parseInt(match[2]);

        // Añadir rotación extra para efecto de tirada
        const extraX = 720 + Math.floor(Math.random() * 360);
        const extraY = 720 + Math.floor(Math.random() * 360);

        const totalX = extraX + finalX;
        const totalY = extraY + finalY;

        dice.style.transform = `rotateX(${totalX}deg) rotateY(${totalY}deg)`;

        setTimeout(() => {
            resultElement.textContent = `¡Toca hacer: ${faces[rolledIndex]}!`;
            resultElement.classList.add('show');
            isRolling = false;
        }, 1800); // Igual al tiempo de transición CSS
    }

    dice.addEventListener('click', rollDice);
    dice.addEventListener('touchstart', function(e) {
        e.preventDefault();
        rollDice();
    });

    window.addEventListener('load', () => {
        setAllFacesToDots();
        dice.style.transform = rotations[4]; // Cara 5 (arriba)
    });
</script>
